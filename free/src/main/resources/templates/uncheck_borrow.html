<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta charset="utf-8" />
		<title>个人信息 - 金融P2P后台管理系统</title>
		<meta name="description" content="This is page-header (.page-header &gt; h1)" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

		<link rel="stylesheet" href="/static/assets/css/bootstrap.min.css" />
		<link rel="stylesheet" href="/static/assets/css/font-awesome.min.css" />
		<link rel="stylesheet" href="/static/assets/css/ace.min.css" id="main-ace-style" />
		
		<link rel="stylesheet" href="/static/assets/css/ace-skins.min.css" />
		<link rel="stylesheet" href="/static/assets/css/ace-rtl.min.css" />
		
	</head>

	<body class="no-skin">
		<div id="navbar" class="navbar navbar-default">
			<div class="navbar-container" id="navbar-container">
				<div class="navbar-header pull-left">
					<a href="index.html" class="navbar-brand">
						<small>
							<img src="/static/assets/avatars/logo.png" alt="" />
						</small>
					</a>
				</div>

				<div class="navbar-buttons navbar-header pull-right" role="navigation">
					<ul class="nav ace-nav">

						<li class="light-blue">
							<a data-toggle="dropdown" href="#" class="dropdown-toggle">
								<img class="nav-user-photo" src="/static/assets/avatars/user.jpg" alt="Jason's Photo" />
								<span class="user-info">
									欢迎您<br />
									XXX
								</span>

								<i class="ace-icon fa fa-caret-down"></i>
							</a>

							<ul class="user-menu dropdown-menu-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
								<li>
									<a href="personal.html">
										<i class="ace-icon fa fa-user"></i>
										个人信息设置
									</a>
								</li>

								<li class="divider"></li>

								<li>
									<a href="login.html">
										<i class="ace-icon fa fa-power-off"></i>
										退出
									</a>
								</li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
		</div>

		<!-- /section:basics/navbar.layout -->
		<div class="main-container" id="main-container">

			<div id="sidebar" class="sidebar responsive">


				<ul class="nav nav-list">
					<li class="active">
						<a href="/index">
							<i class="menu-icon fa fa-tachometer"></i>
							<span class="menu-text"> 菜单列表 </span>
						</a>
						<b class="arrow"></b>
					</li>

					<li class="#">
						<a href="" class="dropdown-toggle">
							<i class="menu-icon fa fa-tag"></i>
							<span class="menu-text">用户管理 </span>
							<b class="arrow fa fa-angle-down"></b>
						</a>

						<b class="arrow"></b>
						<ul class="submenu">

							<li class="">
								<a href="/user/user/getUserInfo">
									<i class="menu-icon fa fa-caret-right"></i>
									用户信息
								</a>

								<b class="arrow"></b>
							</li>
							<li class="">
								<a href="/user/employee/getEmployeeInfo">
									<i class="menu-icon fa fa-caret-right"></i>
									后台用户信息
								</a>

								<b class="arrow"></b>
							</li>

							<li class="">
								<a href="/user/role/getRoleInfo">
									<i class="menu-icon fa fa-caret-right"></i>
									角色信息
								</a>

								<b class="arrow"></b>
							</li>
						</ul>
					</li>

					<li class="">
						<a href="#" class="dropdown-toggle">
							<i class="menu-icon fa fa-desktop"></i>
							<span class="menu-text">借款管理</span>
							<b class="arrow fa fa-angle-down"></b>
						</a>

						<b class="arrow"></b>

						<ul class="submenu">

							<li class="">
								<a href="/borrow/uncheckBorrow/getUncheckBorrow">
									<i class="menu-icon fa fa-caret-right"></i>
									未审核借款
								</a>

								<b class="arrow"></b>
							</li>

							<li class="">
								<a href="/borrow/checkBorrow/getCheckBorrow">
									<i class="menu-icon fa fa-caret-right"></i>
									已审核借款
								</a>

								<b class="arrow"></b>
							</li>

							<li class="">
								<a href="/borrow/unPassBorrow/getUnPassBorrow">
									<i class="menu-icon fa fa-caret-right"></i>
									未通过借款
								</a>
								<b class="arrow"></b>
							</li>
						</ul>
					</li>

					<!--  -->
					<li class="">
						<a href="/project/getProject">
							<i class="menu-icon fa fa-list-alt"></i>
							<span class="menu-text">项目管理</span>
						</a>
						<b class="arrow"></b>

					</li>

					<li class="">
						<a href="#" class="dropdown-toggle">
							<i class="menu-icon fa fa-list"></i>
							<span class="menu-text">还款管理</span>

							<b class="arrow fa fa-angle-down"></b>
						</a>

						<b class="arrow"></b>
						<ul class="submenu">

							<li class="">
								<a href="/repayment/unRepayment/getUnRepayment">
									<i class="menu-icon fa fa-caret-right"></i>
									未还款信息
								</a>

								<b class="arrow"></b>
							</li>

							<li class="">
								<a href="/repayment/repayment/getRepayment">
									<i class="menu-icon fa fa-caret-right"></i>
									已还款信息
								</a>

								<b class="arrow"></b>
							</li>
						</ul>
					</li>


					<li class="">
						<a href="#" class="dropdown-toggle">
							<i class="menu-icon fa fa-pencil-square-o"></i>
							<span class="menu-text">统计管理</span>

							<b class="arrow fa fa-angle-down"></b>
						</a>

						<b class="arrow"></b>
						<ul class="submenu">
							<li class="">
								<a href="/statistics/statisticsUser/getStatisticsUser">
									<i class="menu-icon fa fa-caret-right"></i>
									近一周用户使用信息
								</a>
								<b class="arrow"></b>
							</li>

						</ul>
					</li>

				</ul>

				<div class="sidebar-toggle sidebar-collapse" id="sidebar-collapse">
					<i class="ace-icon fa fa-angle-double-left" data-icon1="ace-icon fa fa-angle-double-left" data-icon2="ace-icon fa fa-angle-double-right"></i>
				</div>

			</div>

			<div class="main-content">
				
				<div class="breadcrumbs" id="breadcrumbs">
					<ul class="breadcrumb">
						<li>
							<i class="ace-icon fa fa-home home-icon"></i>
							<a href="index.html">首页</a>
						</li>
						<li>
							<a href="javascript:void(0)">借款管理</a>
						</li>
						<li>
							<a href="uncheck_borrow.html">未审核借款</a>
						</li>
					</ul>
				</div>
				
				<div class="page-content">
				
					<div class="page-content-area">
						<div class="row">
							<div class="col-xs-12">
								<div class="row">
									<div class="col-xs-12">
										<div class="table-header">
											未审核借款管理
										</div>
										<form id="myform" action="/borrow/uncheckBorrow/getUncheckBorrow" method="post" >
										<table width="80%" class="CSSearchTbl" cellpadding="0" cellspacing="0">
			                                <tr>
			                                    <td class="left">申请人：</td>
			                                    <td class="right"><input type="text" size="16"  name="userName" th:value="${mdLoan.userName}"/></td>
			                                    
												<td class="left">手机号：</td>
												<td class="right"><input type="text" size="16" name="telephone" th:value="${mdLoan.telephone}"/></td>

												<td class="left">借款金额：</td>
			                                    <td class="right"><input type="text" size="16" class="datePicker"  name="minMoney" th:value="${mdLoan.minMoney}"/> 至 <input name="maxMoney" type="text" size="16" class="datePicker" th:value="${mdLoan.maxMoney}" /></td>
			                                    
												<td class="left" colspan="18">
			                                    	<button class="btn btn-primary pull-left col-sm-12 tbl-search" data-dismiss="modal" type="submit">
														开始搜索 
														<i class="ace-icon fa fa-search"></i>
													</button>
												</td>

												<input type="hidden" name="pageNum" id="pageNum" value="">
			                                </tr>
			                            </table>
										</form>
										<div class="table-responsive">
											<table id="sample-table-2" class="table table-striped table-bordered table-hover">
												<thead>
													<tr>
														<th class="center">
															<label class="position-relative">
																<input type="checkbox" class="ace" id="selectAll" />
																<span class="lbl"></span>
															</label>
														</th>
														<th>申请人</th>
				                                        <th>手机号</th>
														<th>所在地区</th>
				                                        <th>借款金额</th>
				                                        <th>借款期限</th>
				                                        <th>借款方式</th>
				                                        <th>借款用途</th>
														<th>借款时间</th>
														<th>操作</th>
													</tr>
												</thead>

												<tbody>
													<tr th:each="mdLoan:${pageInfo.list}">
														<td class="center">
															<label class="position-relative">
																<input type="checkbox" class="ace"  name="ids"/>
																<span class="lbl"></span>
															</label>
														</td>
														<td th:text="${mdLoan.userName}"></td>
														<td th:text="${mdLoan.telephone}"></td>
				                                        <td th:text="${mdLoan.address}"></td>
				                                        <td th:text="'￥'+ ${mdLoan.loanMoney}"></td>
														<td th:text="${mdLoan.loanTerm}+'月'"></td>
				                                        <td th:switch="${mdLoan.loanMode}">
															<span class="label label-sm label-warning" th:case="1">信用</span>
															<span class="label label-sm label-warning" th:case="2">质押</span>
															<span class="label label-sm label-warning" th:case="3">抵押</span>
															<span class="label label-sm label-warning" th:case="4">担保</span>
														</td>
														<td th:switch="${mdLoan.loanUse}">
															<span  th:case="1">短期周转</span>
															<span  th:case="2">生意周转</span>
															<span  th:case="3">生活周转</span>
															<span  th:case="4">购物消费</span>
															<span  th:case="5">不提现借款</span>
															<span  th:case="6">创业借款</span>
															<span  th:case="7">其他借款</span>
														</td>
				                                        <td th:text="${#dates.format(mdLoan.loanTime,'yyyy-MM-dd HH:mm:ss')}"></td>
														<td th:text="${mdLoan.id}" hidden></td>
														<td>
															<div class="hidden-sm hidden-xs btn-group">
																<span class="label label-inverse arrowed" onclick="batch_update(3)" >撤回</span>
																<span class="label label-success arrowed-in arrowed-in-right" onclick="batch_update(2)" >审核通过</span>
															</div>
														</td>
													</tr>
												</tbody>
											</table>

											
											<!--分页开始-->

											<div class="modal-footer no-margin-top">
												<div class="col-md-6">
													当前第 [[${pageInfo.pageNum}]]页,共 [[${pageInfo.pages}]] 页.一共 [[${pageInfo.total}]] 条记录
												</div>

												<ul class="pagination pull-right no-margin">
													<li th:if="${pageInfo.hasPreviousPage}">
														<a  th:onclick="'javascript:commit(1);'">首页</a>
													</li>

													<li class="prev" th:if="${pageInfo.hasPreviousPage}">
														<!--th:href="'/borrow/uncheckBorrow/getUncheckBorrow?pageNum='+${pageInfo.prePage}" -->
														<a  th:onclick="'javascript:commit('+${pageInfo.prePage}+');'">
															<i class="ace-icon fa fa-angle-double-left"></i>
														</a>
													</li>
													<!--遍历条数-->
													<li th:each="nav:${pageInfo.navigatepageNums}">
														<!--th:href="'/borrow/uncheckBorrow/getUncheckBorrow?pageNum='+${nav}" -->
														<a  th:text="${nav}" th:if="${nav != pageInfo.pageNum}" th:onclick="'javascript:commit('+${nav}+');'"></a>
														<span style="font-weight: bold;background: #6faed9;" th:if="${nav == pageInfo.pageNum}" th:text="${nav}" ></span>
													</li>

													<li class="next" th:if="${pageInfo.hasNextPage}">
														<!--th:href="'/borrow/uncheckBorrow/getUncheckBorrow?pageNum='+${pageInfo.nextPage}" -->
														<a  th:onclick="'javascript:commit('+${pageInfo.nextPage}+');'">
															<i class="ace-icon fa fa-angle-double-right"></i>
														</a>
													</li>

													<li>
														<!--th:href="'/borrow/uncheckBorrow/getUncheckBorrow?pageNum='+${pageInfo.pages}"-->
														<a th:onclick="'javascript:commit('+${pageInfo.pages}+');'">尾页</a>
													</li>
												</ul>
											</div>

										</div>
									</div>
								</div>

							</div><!-- /.col -->
						</div><!-- /.row -->
					</div>
				</div>
			</div>
			

			<div class="footer">
				<div class="footer-inner">
					<div class="footer-content">
						<span class="bigger-120">
							 金融P2P后台 &copy; 2019
						</span>
					</div>
				</div>
			</div>

			<a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
				<i class="ace-icon fa fa-angle-double-up icon-only bigger-110"></i>
			</a>
		</div><!-- /.main-container -->

		
		<script type="text/javascript" src='/static/assets/js/jquery.min.js'></script>
		
		<script type="text/javascript">
			if('ontouchstart' in document.documentElement) document.write("<script src='/static/assets/js/jquery.mobile.custom.min.js'>"+"<"+"/script>");
		</script>
		<script src="/static/assets/js/bootstrap.min.js"></script>
		<script src="/static/assets/js/jquery-ui.custom.min.js"></script>
		<script src="/static/assets/js/jquery.ui.touch-punch.min.js"></script>
		<script src="/static/assets/js/ace-elements.min.js"></script>
		<script src="/static/assets/js/ace.min.js"></script>

		<script th:inline="javascript">
			// 复选框的全选和全不选
			$(function() {
				$("#selectAll").click(function() {
					$(":checkbox[name='ids']").prop("checked", this.checked); // this指代的你当前选择的这个元素的JS对象
				});
			});

			function commit(value) {
				debugger;
				var pageNum = value;
				$("#pageNum").val(pageNum);
				//alert(pageNum)
				$("#myform").submit();
			}

			/*获取ids,批量删除*/
			function batch_update(value) {
				var approvalStatus = value;
				var mdLoanIds =[];
				var checkLength = $("input:checkbox[name='ids']:checked").length;
				if(checkLength == 0) {
					alert("请至少选择一条！");
					return;
				}else {
					//$('input:checkbox')
					$("input:checkbox[name='ids']:checked").each(function(){
						if($(this).prop("checked")){ //如果值为checked表明选中了
							//alert($(this).closest('tr').find('td').eq(9).text()); //获取eq为9的那一列数据
							debugger
							var id = $(this).closest('tr').find('td').eq(9).text();
							mdLoanIds.push(id);
						}
					});
				}
				var bool = confirm('批量修改后不可恢复，谨慎操作！');
				debugger;
				if (bool){

					$.ajax({
                            type: 'POST',
                            url: '/borrow/uncheckBorrow/updateApprovalStatus',
                            data: {
							approvalStatus:approvalStatus,
							mdLoanIds:mdLoanIds
                            },
						    traditional: true,
                            success: function (data) {
                                if (data.status=='SUCCESS') {
                                	alert("提交成功!")
                                } else {
									alert("提交失败!")
                                }
                            },
                            error: function (data) {

                            },
                        });
					alert("OK")
				}
			}

		</script>

	</body>
</html>
